(()=>{function e(e,t,n,r,a,o,c){try{var s=e[o](c),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(a,o){var c=t.apply(n,r);function s(t){e(c,a,o,s,i,"next",t)}function i(t){e(c,a,o,s,i,"throw",t)}s(void 0)}))}}var n=document.getElementById("videoContainer"),r=document.getElementsByClassName("container-box")[0],a=document.getElementById("commentForm"),o=a.querySelector("textarea"),c=document.getElementsByClassName("del"),s=r.dataset.username,i=r.dataset.userid,u=function(e,t){var n=document.querySelector(".video__comments ul"),r=document.createElement("li");r.dataset.commentid=t;var a,o=document.createElement("a"),c=document.createElement("span"),u=document.createElement("span");u.innerText=e,s?(c.innerText=s,o.href="/users/".concat(i),(a=document.createElement("span")).innerText="삭제",a.className="del",a.addEventListener("click",m)):c.innerText="익명",o.appendChild(c),r.appendChild(u),r.appendChild(o),s&&r.appendChild(a),r.className="video__comment",u.className="comment__text",n.prepend(r)},d=function(){var e=t(regeneratorRuntime.mark((function e(t){var r,a,c,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=o.value,a=n.dataset.videoid,""!==r){e.next=5;break}return e.abrupt("return");case 5:return e.next=8,fetch("/api/videos/".concat(a,"/comments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:r})});case 8:if(201!==(c=e.sent).status){e.next=16;break}return o.value="",e.next=13,c.json();case 13:s=e.sent,i=s.newCommentId,u(r,i);case 16:case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=t(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.parentElement,r=n.dataset.commentid,e.next=4,fetch("/api/del-comment",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({commentId:r})});case 4:200===e.sent.status&&(console.log(n),n.remove());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();a.addEventListener("submit",d),a.addEventListener("keypress",(function(e){"Enter"==e.key&&(e.preventDefault(),d(e))}));for(var l=0;l<c.length;l++)c[l].addEventListener("click",m)})();